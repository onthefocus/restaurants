<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.16/dist/tailwind.min.css" rel="stylesheet">
    <title>Webpage Skeleton</title>
</head>

<body class="bg-gray-100">
    <!-- Success Indicator -->
    <div id="success-modal" class="fixed z-10 hidden inset-0 bg-black bg-opacity-50 flex items-center justify-center">
        <div class="bg-white p-6 rounded shadow-md">
            <span class="text-green-500">âœ“ Value Recorded Successfully</span>
        </div>
    </div>

    <div class="container mx-auto py-10">
        <div class="bg-white rounded-lg p-6 shadow-md">
            <!-- First Part -->
            <div class="mb-6">
                <div class="mb-2">
                    <p class="font-semibold">Network name:</p>
                    <span id="network-name" class="font-medium">Hesburger</span>
                </div>
                <div>
                    <p class="font-semibold">Location:</p>
                    <span id="location" class="font-medium">Ukmerges Street</span>
                </div>
            </div>
            <p class="text-left font-semibold mb-4">Devices</p>
            <div class="flex justify-between mt-6">
                <button id="add-modal" class="bg-blue-500 text-white px-4 py-2 rounded">Add new Device</button>
                <button id="remove-modal" class="bg-red-500 text-white px-4 py-2 rounded">Remove Device</button>
            </div>
            <br></br>
            <hr class="border-gray-300 mb-6">

            <!-- Second Part: Multi Modal -->
            <template id="device-modal-template">
                <div class="space-y-6">
                    <!-- Device Modal -->
                    <div class="bg-gray-100 rounded-lg p-6 shadow-md">
                        <div class="flex justify-between mb-4">
                            <div>
                                <p class="font-semibold">Location Name:</p>
                                <input id="location-name" type="text" class="border border-gray-300 rounded p-2"
                                    value="">
                            </div>
                            <div>
                                <label for="time" class="font-semibold">Time:</label>
                                <input id="time" type="text" class="border border-gray-300 rounded p-2">

                            </div>
                        </div>
                        <div class="flex justify-between mb-4">
                            <div>
                                <p class="font-semibold">Last Replacement:</p>
                                <span id="last-replacement" class="font-medium">04-12 12:00</span>
                            </div>
                            <div>
                                <label for="value" class="font-semibold">Value:</label>
                                <input id="value" type="text" class="border border-gray-300 rounded p-2">
                            </div>
                        </div>
                        <div class="flex justify-between mb-4">
                            <button id="replace" class="bg-blue-500 text-white px-4 py-2 rounded">Replace</button>
                            <button id="record" class="bg-green-500 text-white px-4 py-2 rounded">Record</button>
                        </div>

                    </div>
                    <!-- /Device Modal -->
                </div>
            </template>
        </div>
    </div>

    <script>
        // Function to get the current date and time
  function getDateTime() {
    const now = new Date();
    const date = now.toLocaleDateString('en-US');
    const time = now.toLocaleTimeString('en-US', { hour12: false });
    return `${date} ${time}`;
  }


  // Function to add a new device
  document.getElementById('add-modal').addEventListener('click', function () {
    const template = document.getElementById('device-modal-template');
    const clone = template.content.cloneNode(true);
    const container = document.querySelector('.container .bg-white');
    container.appendChild(clone);

    // Set the current date and time as the placeholder for the Time field
    const timeInput = container.lastElementChild.querySelector('#time');
    timeInput.placeholder = getDateTime();

    // Set the Last Replacement date when the Replace button is clicked
    container.lastElementChild.querySelector('#replace').addEventListener('click', function () {
      const lastReplacement = this.parentElement.parentElement.querySelector('#last-replacement');
      lastReplacement.textContent = getDateTime();
    });

    // Save the new device to localStorage
  });

  // Function to remove the last created device
  document.getElementById('remove-modal').addEventListener('click', function () {
    const container = document.querySelector('.container .bg-white');
    const lastChild = container.lastElementChild;

    if (lastChild && lastChild.matches('.space-y-6')) {
      container.removeChild(lastChild);
    }
  });
      
      
  async function fetchDevices(restaurantId) {
    const response = await fetch('http://api.restaurants.provocati.lt/api/devices');
    const devices = await response.json();

    const filteredDevices = devices.filter(device => device.restaurant_id === restaurantId);

    filteredDevices.forEach(device => {
      // Add a new device
      document.getElementById('add-modal').click();

      // Set the name of the newly added device
      const container = document.querySelector('.container .bg-white');
      const deviceElement = container.lastElementChild;
      deviceElement.querySelector('#location-name').value = device.name;
    });
  }
  fetchDevices(1)
      
      </script>
      

</body>

</html>